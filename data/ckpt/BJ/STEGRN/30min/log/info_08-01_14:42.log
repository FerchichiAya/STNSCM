2024-08-01 14:42:21,133 - __main__ - INFO - Log directory: data/ckpt/BJ/STEGRN/30min/log
2024-08-01 14:42:21,146 - __main__ - INFO - {'expid': 1, 'runs': 2, 'dataset_name': 'all_data_r1_d1_w1_30min.npz', 'device': 'cuda:0', 'log_level': 'INFO', 'base_path': 'data/train_data/BJ', 'save': 'data/ckpt/BJ', 'model_name': 'STEGRN', 'data': {'cluster_num': 64, 'freq': '30min', 'name': 'bj_bike', 'num_for_predict': 6, 'num_for_target': 2, 'num_of_days': 1, 'num_of_hours': 1, 'num_of_weeks': 1, 'num_shift': 2, 'points_per_hour': 2, 'test_batch_size': 64, 'train_batch_size': 64, 'val_batch_size': 64}, 'model': {'adj': 'affinity', 'alpha': 1, 'dropout_prob': 0.0, 'dropout_type': 'zoneout', 'dyn_norm': 'D-1', 'fusion_mode': 'split', 'gcn_depth': 2, 'graph_type': 'geo_od_dyn', 'hidden_dim': 64, 'input_dim': 2, 'loss_type': 'Smooth', 'num_of_head': 1, 'output_dim': 2, 'time_dim': 59, 'use_transform': True}, 'preprocess': {'OD_affinity_file': 'OD_affinity.npy', 'datasets_file': 'all_data', 'geo_affinity_file': 'geo_affinity.npy', 'nyc_holidays': ['2021-05-01', '2021-05-02', '2021-05-03', '2021-05-04', '2021-06-03', '2021-06-04', '2021-06-05']}, 'train': {'base_lr': 0.001, 'best_mode': 'data/ckpt/BJ/BJ-model.pth', 'test_only': True, 'cl_decay_steps': 1000, 'epoch_start': 0, 'epochs': 200, 'global_step': 0, 'load_initial': False, 'lr_decay_ratio': 0.2, 'max_grad_norm': 5, 'milestones': [60, 120, 180, 200], 'min_learning_rate': 2e-06, 'new_training': True, 'print_every': 1, 'tolerance': 100, 'use_curriculum_learning': True, 'weight_decay': 0.0001}}
2024-08-01 14:42:21,146 - __main__ - INFO - data/train_data/BJ/all_data_r1_d1_w1_30min.npz
2024-08-01 14:42:21,146 - __main__ - INFO - data/ckpt/BJ/STEGRN/30min/log
2024-08-01 14:42:21,692 - __main__ - INFO - ('train x', (4362, 64, 18, 2))
2024-08-01 14:42:21,692 - __main__ - INFO - ('train target', (4362, 64, 2, 2))
2024-08-01 14:42:21,693 - __main__ - INFO - ('train x time', (4362, 18, 6))
2024-08-01 14:42:21,693 - __main__ - INFO - ('train target time', (4362, 2, 6))
2024-08-01 14:42:21,693 - __main__ - INFO - ('train pos', (4362, 4))
2024-08-01 14:42:21,693 - __main__ - INFO - 

2024-08-01 14:42:21,693 - __main__ - INFO - ('val x', (545, 64, 18, 2))
2024-08-01 14:42:21,694 - __main__ - INFO - ('val target', (545, 64, 2, 2))
2024-08-01 14:42:21,694 - __main__ - INFO - ('val x time', (545, 18, 6))
2024-08-01 14:42:21,694 - __main__ - INFO - ('val target time', (545, 2, 6))
2024-08-01 14:42:21,694 - __main__ - INFO - ('val pos', (545, 4))
2024-08-01 14:42:21,694 - __main__ - INFO - 

2024-08-01 14:42:21,694 - __main__ - INFO - ('test x', (545, 64, 18, 2))
2024-08-01 14:42:21,695 - __main__ - INFO - ('test target', (545, 64, 2, 2))
2024-08-01 14:42:21,695 - __main__ - INFO - ('test x time', (545, 18, 6))
2024-08-01 14:42:21,695 - __main__ - INFO - ('test target time', (545, 2, 6))
2024-08-01 14:42:21,695 - __main__ - INFO - ('test pos', (545, 4))
2024-08-01 14:42:21,695 - __main__ - INFO - 

2024-08-01 14:42:21,696 - __main__ - INFO - scaler.mean : 90.54989856764863, scaler.std : 143.57267603277353
2024-08-01 14:42:21,696 - __main__ - INFO - 

2024-08-01 14:42:21,696 - __main__ - INFO - time feature index : {'time': (0, 3), 'weather_numerical': (3, 6)}
2024-08-01 14:42:21,697 - __main__ - INFO - time weather data : [[Timestamp('2021-05-01 00:00:00') 5 0 ... -0.13878310472443348
  -3.3157922872053995 -0.7646244036924886]
 [Timestamp('2021-05-01 00:30:00') 5 1 ... -0.13878310472443348
  -3.41756948903783 -0.7646244036924886]
 [Timestamp('2021-05-01 01:00:00') 5 2 ... -0.13878310472443348
  -3.5193466908702606 -0.35891374678582444]
 ...
 [Timestamp('2021-08-31 22:30:00') 1 45 ... -0.13878310472443348
  -0.3133648331486997 -1.9817563744124813]
 [Timestamp('2021-08-31 23:00:00') 1 46 ... -0.13878310472443348
  -0.7713622413946369 -1.9817563744124813]
 [Timestamp('2021-08-31 23:30:00') 1 47 ... -0.13878310472443348
  -0.8222508423108522 -1.9817563744124813]]
2024-08-01 14:42:21,715 - __main__ - INFO - STEGRN
2024-08-01 14:42:23,060 - __main__ - INFO - loading data/ckpt/BJ/BJ-model.pth
2024-08-01 14:42:23,089 - __main__ - INFO - model load success! data/ckpt/BJ/BJ-model.pth
2024-08-01 14:42:23,089 - __main__ - INFO - Net's state_dict:
2024-08-01 14:42:23,091 - __main__ - INFO - encoder.RNNCell.0.week_x_FC.weight	torch.Size([64, 2])
2024-08-01 14:42:23,093 - __main__ - INFO - encoder.RNNCell.0.week_x_FC.bias	torch.Size([64])
2024-08-01 14:42:23,095 - __main__ - INFO - encoder.RNNCell.0.week_time_FC.weight	torch.Size([64, 59])
2024-08-01 14:42:23,097 - __main__ - INFO - encoder.RNNCell.0.week_time_FC.bias	torch.Size([64])
2024-08-01 14:42:23,099 - __main__ - INFO - encoder.RNNCell.0.week_FC.weight	torch.Size([64, 128])
2024-08-01 14:42:23,101 - __main__ - INFO - encoder.RNNCell.0.week_FC.bias	torch.Size([64])
2024-08-01 14:42:23,103 - __main__ - INFO - encoder.RNNCell.0.day_x_FC.weight	torch.Size([64, 2])
2024-08-01 14:42:23,105 - __main__ - INFO - encoder.RNNCell.0.day_x_FC.bias	torch.Size([64])
2024-08-01 14:42:23,107 - __main__ - INFO - encoder.RNNCell.0.day_time_FC.weight	torch.Size([64, 59])
2024-08-01 14:42:23,109 - __main__ - INFO - encoder.RNNCell.0.day_time_FC.bias	torch.Size([64])
2024-08-01 14:42:23,111 - __main__ - INFO - encoder.RNNCell.0.day_FC.weight	torch.Size([64, 128])
2024-08-01 14:42:23,113 - __main__ - INFO - encoder.RNNCell.0.day_FC.bias	torch.Size([64])
2024-08-01 14:42:23,115 - __main__ - INFO - encoder.RNNCell.0.hour_x_FC.weight	torch.Size([64, 2])
2024-08-01 14:42:23,117 - __main__ - INFO - encoder.RNNCell.0.hour_x_FC.bias	torch.Size([64])
2024-08-01 14:42:23,119 - __main__ - INFO - encoder.RNNCell.0.hour_time_FC.weight	torch.Size([64, 59])
2024-08-01 14:42:23,121 - __main__ - INFO - encoder.RNNCell.0.hour_time_FC.bias	torch.Size([64])
2024-08-01 14:42:23,123 - __main__ - INFO - encoder.RNNCell.0.hour_FC.weight	torch.Size([64, 128])
2024-08-01 14:42:23,126 - __main__ - INFO - encoder.RNNCell.0.hour_FC.bias	torch.Size([64])
2024-08-01 14:42:23,128 - __main__ - INFO - encoder.RNNCell.0.fusion_x_time2.weight	torch.Size([64, 192])
2024-08-01 14:42:23,130 - __main__ - INFO - encoder.RNNCell.0.fusion_x_time2.bias	torch.Size([64])
2024-08-01 14:42:23,133 - __main__ - INFO - encoder.RNNCell.0.gate_FC2.weight	torch.Size([64, 64])
2024-08-01 14:42:23,135 - __main__ - INFO - encoder.RNNCell.0.gate_FC2.bias	torch.Size([64])
2024-08-01 14:42:23,139 - __main__ - INFO - encoder.RNNCell.0.info_FC2.weight	torch.Size([64, 64])
2024-08-01 14:42:23,141 - __main__ - INFO - encoder.RNNCell.0.info_FC2.bias	torch.Size([64])
2024-08-01 14:42:23,144 - __main__ - INFO - encoder.RNNCell.0.dynGraph.start_FC.weight	torch.Size([64, 128])
2024-08-01 14:42:23,146 - __main__ - INFO - encoder.RNNCell.0.dynGraph.start_FC.bias	torch.Size([64])
2024-08-01 14:42:23,149 - __main__ - INFO - encoder.RNNCell.0.dynGraph.fc.0.weight	torch.Size([4, 64])
2024-08-01 14:42:23,151 - __main__ - INFO - encoder.RNNCell.0.dynGraph.fc.2.weight	torch.Size([64, 4])
2024-08-01 14:42:23,153 - __main__ - INFO - encoder.RNNCell.0.GCN_update1.weight	torch.Size([4])
2024-08-01 14:42:23,155 - __main__ - INFO - encoder.RNNCell.0.GCN_update1.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:23,157 - __main__ - INFO - encoder.RNNCell.0.GCN_update1.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:23,158 - __main__ - INFO - encoder.RNNCell.0.GCN_update2.weight	torch.Size([4])
2024-08-01 14:42:23,161 - __main__ - INFO - encoder.RNNCell.0.GCN_update2.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:23,162 - __main__ - INFO - encoder.RNNCell.0.GCN_update2.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:23,164 - __main__ - INFO - encoder.RNNCell.0.GCN_reset1.weight	torch.Size([4])
2024-08-01 14:42:23,167 - __main__ - INFO - encoder.RNNCell.0.GCN_reset1.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:23,169 - __main__ - INFO - encoder.RNNCell.0.GCN_reset1.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:23,170 - __main__ - INFO - encoder.RNNCell.0.GCN_reset2.weight	torch.Size([4])
2024-08-01 14:42:23,172 - __main__ - INFO - encoder.RNNCell.0.GCN_reset2.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:23,174 - __main__ - INFO - encoder.RNNCell.0.GCN_reset2.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:23,177 - __main__ - INFO - encoder.RNNCell.0.GCN_cell1.weight	torch.Size([4])
2024-08-01 14:42:23,179 - __main__ - INFO - encoder.RNNCell.0.GCN_cell1.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:23,180 - __main__ - INFO - encoder.RNNCell.0.GCN_cell1.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:23,182 - __main__ - INFO - encoder.RNNCell.0.GCN_cell2.weight	torch.Size([4])
2024-08-01 14:42:23,184 - __main__ - INFO - encoder.RNNCell.0.GCN_cell2.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:23,186 - __main__ - INFO - encoder.RNNCell.0.GCN_cell2.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:23,188 - __main__ - INFO - encoder.RNNCell.0.layerNorm.weight	torch.Size([64])
2024-08-01 14:42:23,190 - __main__ - INFO - encoder.RNNCell.0.layerNorm.bias	torch.Size([64])
2024-08-01 14:42:23,192 - __main__ - INFO - decoder.RNNCell.0.input_FC.weight	torch.Size([64, 61])
2024-08-01 14:42:23,194 - __main__ - INFO - decoder.RNNCell.0.input_FC.bias	torch.Size([64])
2024-08-01 14:42:23,197 - __main__ - INFO - decoder.RNNCell.0.fusion_x_time.weight	torch.Size([64, 64])
2024-08-01 14:42:23,198 - __main__ - INFO - decoder.RNNCell.0.fusion_x_time.bias	torch.Size([64])
2024-08-01 14:42:23,200 - __main__ - INFO - decoder.RNNCell.0.gate_FC1.weight	torch.Size([64, 64])
2024-08-01 14:42:23,204 - __main__ - INFO - decoder.RNNCell.0.gate_FC1.bias	torch.Size([64])
2024-08-01 14:42:23,205 - __main__ - INFO - decoder.RNNCell.0.info_FC1.weight	torch.Size([64, 64])
2024-08-01 14:42:23,207 - __main__ - INFO - decoder.RNNCell.0.info_FC1.bias	torch.Size([64])
2024-08-01 14:42:23,209 - __main__ - INFO - decoder.RNNCell.0.dynGraph.start_FC.weight	torch.Size([64, 128])
2024-08-01 14:42:23,211 - __main__ - INFO - decoder.RNNCell.0.dynGraph.start_FC.bias	torch.Size([64])
2024-08-01 14:42:23,213 - __main__ - INFO - decoder.RNNCell.0.dynGraph.fc.0.weight	torch.Size([4, 64])
2024-08-01 14:42:23,215 - __main__ - INFO - decoder.RNNCell.0.dynGraph.fc.2.weight	torch.Size([64, 4])
2024-08-01 14:42:23,218 - __main__ - INFO - decoder.RNNCell.0.GCN_update1.weight	torch.Size([4])
2024-08-01 14:42:23,220 - __main__ - INFO - decoder.RNNCell.0.GCN_update1.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:23,222 - __main__ - INFO - decoder.RNNCell.0.GCN_update1.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:23,224 - __main__ - INFO - decoder.RNNCell.0.GCN_update2.weight	torch.Size([4])
2024-08-01 14:42:23,226 - __main__ - INFO - decoder.RNNCell.0.GCN_update2.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:23,228 - __main__ - INFO - decoder.RNNCell.0.GCN_update2.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:23,230 - __main__ - INFO - decoder.RNNCell.0.GCN_reset1.weight	torch.Size([4])
2024-08-01 14:42:23,232 - __main__ - INFO - decoder.RNNCell.0.GCN_reset1.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:23,234 - __main__ - INFO - decoder.RNNCell.0.GCN_reset1.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:23,236 - __main__ - INFO - decoder.RNNCell.0.GCN_reset2.weight	torch.Size([4])
2024-08-01 14:42:23,237 - __main__ - INFO - decoder.RNNCell.0.GCN_reset2.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:23,240 - __main__ - INFO - decoder.RNNCell.0.GCN_reset2.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:23,241 - __main__ - INFO - decoder.RNNCell.0.GCN_cell1.weight	torch.Size([4])
2024-08-01 14:42:23,243 - __main__ - INFO - decoder.RNNCell.0.GCN_cell1.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:23,246 - __main__ - INFO - decoder.RNNCell.0.GCN_cell1.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:23,248 - __main__ - INFO - decoder.RNNCell.0.GCN_cell2.weight	torch.Size([4])
2024-08-01 14:42:23,249 - __main__ - INFO - decoder.RNNCell.0.GCN_cell2.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:23,251 - __main__ - INFO - decoder.RNNCell.0.GCN_cell2.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:23,253 - __main__ - INFO - decoder.RNNCell.0.layerNorm.weight	torch.Size([64])
2024-08-01 14:42:23,255 - __main__ - INFO - decoder.RNNCell.0.layerNorm.bias	torch.Size([64])
2024-08-01 14:42:23,257 - __main__ - INFO - decoder.fc_final.weight	torch.Size([2, 64])
2024-08-01 14:42:23,259 - __main__ - INFO - decoder.fc_final.bias	torch.Size([2])
2024-08-01 14:42:23,261 - __main__ - INFO - transform.FC_q.weight	torch.Size([64, 59])
2024-08-01 14:42:23,263 - __main__ - INFO - transform.FC_q.bias	torch.Size([64])
2024-08-01 14:42:23,265 - __main__ - INFO - transform.FC_k.weight	torch.Size([64, 177])
2024-08-01 14:42:23,267 - __main__ - INFO - transform.FC_k.bias	torch.Size([64])
2024-08-01 14:42:23,269 - __main__ - INFO - transform.FC_v.weight	torch.Size([64, 64])
2024-08-01 14:42:23,271 - __main__ - INFO - transform.FC_v.bias	torch.Size([64])
2024-08-01 14:42:23,273 - __main__ - INFO - transform.FC.weight	torch.Size([64, 128])
2024-08-01 14:42:23,275 - __main__ - INFO - transform.FC.bias	torch.Size([64])
2024-08-01 14:42:23,276 - __main__ - INFO - Net's total params:415282
2024-08-01 14:42:23,276 - __main__ - INFO - Optimizer's state_dict:
2024-08-01 14:42:23,277 - __main__ - INFO - state	{}
2024-08-01 14:42:23,278 - __main__ - INFO - param_groups	[{'lr': 0.001, 'betas': (0.9, 0.999), 'eps': 1e-08, 'weight_decay': 0.0001, 'amsgrad': False, 'maximize': False, 'foreach': None, 'capturable': False, 'differentiable': False, 'fused': None, 'initial_lr': 0.001, 'params': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]}]
2024-08-01 14:42:23,280 - __main__ - INFO - Number of model parameters is 415282
2024-08-01 14:42:23,281 - __main__ - INFO - Start testing phase.....
2024-08-01 14:42:45,328 - __main__ - INFO - Log directory: data/ckpt/BJ/STEGRN/30min/log
2024-08-01 14:42:45,341 - __main__ - INFO - {'expid': 1, 'runs': 2, 'dataset_name': 'all_data_r1_d1_w1_30min.npz', 'device': 'cuda:0', 'log_level': 'INFO', 'base_path': 'data/train_data/BJ', 'save': 'data/ckpt/BJ', 'model_name': 'STEGRN', 'data': {'cluster_num': 64, 'freq': '30min', 'name': 'bj_bike', 'num_for_predict': 6, 'num_for_target': 2, 'num_of_days': 1, 'num_of_hours': 1, 'num_of_weeks': 1, 'num_shift': 2, 'points_per_hour': 2, 'test_batch_size': 64, 'train_batch_size': 64, 'val_batch_size': 64}, 'model': {'adj': 'affinity', 'alpha': 1, 'dropout_prob': 0.0, 'dropout_type': 'zoneout', 'dyn_norm': 'D-1', 'fusion_mode': 'split', 'gcn_depth': 2, 'graph_type': 'geo_od_dyn', 'hidden_dim': 64, 'input_dim': 2, 'loss_type': 'Smooth', 'num_of_head': 1, 'output_dim': 2, 'time_dim': 59, 'use_transform': True}, 'preprocess': {'OD_affinity_file': 'OD_affinity.npy', 'datasets_file': 'all_data', 'geo_affinity_file': 'geo_affinity.npy', 'nyc_holidays': ['2021-05-01', '2021-05-02', '2021-05-03', '2021-05-04', '2021-06-03', '2021-06-04', '2021-06-05']}, 'train': {'base_lr': 0.001, 'best_mode': 'data/ckpt/BJ/BJ-model.pth', 'test_only': True, 'cl_decay_steps': 1000, 'epoch_start': 0, 'epochs': 200, 'global_step': 0, 'load_initial': False, 'lr_decay_ratio': 0.2, 'max_grad_norm': 5, 'milestones': [60, 120, 180, 200], 'min_learning_rate': 2e-06, 'new_training': True, 'print_every': 1, 'tolerance': 100, 'use_curriculum_learning': True, 'weight_decay': 0.0001}}
2024-08-01 14:42:45,341 - __main__ - INFO - data/train_data/BJ/all_data_r1_d1_w1_30min.npz
2024-08-01 14:42:45,341 - __main__ - INFO - data/ckpt/BJ/STEGRN/30min/log
2024-08-01 14:42:45,899 - __main__ - INFO - ('train x', (4362, 64, 18, 2))
2024-08-01 14:42:45,899 - __main__ - INFO - ('train target', (4362, 64, 2, 2))
2024-08-01 14:42:45,899 - __main__ - INFO - ('train x time', (4362, 18, 6))
2024-08-01 14:42:45,900 - __main__ - INFO - ('train target time', (4362, 2, 6))
2024-08-01 14:42:45,900 - __main__ - INFO - ('train pos', (4362, 4))
2024-08-01 14:42:45,900 - __main__ - INFO - 

2024-08-01 14:42:45,901 - __main__ - INFO - ('val x', (545, 64, 18, 2))
2024-08-01 14:42:45,901 - __main__ - INFO - ('val target', (545, 64, 2, 2))
2024-08-01 14:42:45,901 - __main__ - INFO - ('val x time', (545, 18, 6))
2024-08-01 14:42:45,902 - __main__ - INFO - ('val target time', (545, 2, 6))
2024-08-01 14:42:45,902 - __main__ - INFO - ('val pos', (545, 4))
2024-08-01 14:42:45,902 - __main__ - INFO - 

2024-08-01 14:42:45,903 - __main__ - INFO - ('test x', (545, 64, 18, 2))
2024-08-01 14:42:45,903 - __main__ - INFO - ('test target', (545, 64, 2, 2))
2024-08-01 14:42:45,904 - __main__ - INFO - ('test x time', (545, 18, 6))
2024-08-01 14:42:45,904 - __main__ - INFO - ('test target time', (545, 2, 6))
2024-08-01 14:42:45,904 - __main__ - INFO - ('test pos', (545, 4))
2024-08-01 14:42:45,905 - __main__ - INFO - 

2024-08-01 14:42:45,905 - __main__ - INFO - scaler.mean : 90.54989856764863, scaler.std : 143.57267603277353
2024-08-01 14:42:45,906 - __main__ - INFO - 

2024-08-01 14:42:45,906 - __main__ - INFO - time feature index : {'time': (0, 3), 'weather_numerical': (3, 6)}
2024-08-01 14:42:45,907 - __main__ - INFO - time weather data : [[Timestamp('2021-05-01 00:00:00') 5 0 ... -0.13878310472443348
  -3.3157922872053995 -0.7646244036924886]
 [Timestamp('2021-05-01 00:30:00') 5 1 ... -0.13878310472443348
  -3.41756948903783 -0.7646244036924886]
 [Timestamp('2021-05-01 01:00:00') 5 2 ... -0.13878310472443348
  -3.5193466908702606 -0.35891374678582444]
 ...
 [Timestamp('2021-08-31 22:30:00') 1 45 ... -0.13878310472443348
  -0.3133648331486997 -1.9817563744124813]
 [Timestamp('2021-08-31 23:00:00') 1 46 ... -0.13878310472443348
  -0.7713622413946369 -1.9817563744124813]
 [Timestamp('2021-08-31 23:30:00') 1 47 ... -0.13878310472443348
  -0.8222508423108522 -1.9817563744124813]]
2024-08-01 14:42:45,927 - __main__ - INFO - STEGRN
2024-08-01 14:42:47,243 - __main__ - INFO - loading data/ckpt/BJ/BJ-model.pth
2024-08-01 14:42:47,272 - __main__ - INFO - model load success! data/ckpt/BJ/BJ-model.pth
2024-08-01 14:42:47,273 - __main__ - INFO - Net's state_dict:
2024-08-01 14:42:47,275 - __main__ - INFO - encoder.RNNCell.0.week_x_FC.weight	torch.Size([64, 2])
2024-08-01 14:42:47,277 - __main__ - INFO - encoder.RNNCell.0.week_x_FC.bias	torch.Size([64])
2024-08-01 14:42:47,279 - __main__ - INFO - encoder.RNNCell.0.week_time_FC.weight	torch.Size([64, 59])
2024-08-01 14:42:47,281 - __main__ - INFO - encoder.RNNCell.0.week_time_FC.bias	torch.Size([64])
2024-08-01 14:42:47,283 - __main__ - INFO - encoder.RNNCell.0.week_FC.weight	torch.Size([64, 128])
2024-08-01 14:42:47,285 - __main__ - INFO - encoder.RNNCell.0.week_FC.bias	torch.Size([64])
2024-08-01 14:42:47,287 - __main__ - INFO - encoder.RNNCell.0.day_x_FC.weight	torch.Size([64, 2])
2024-08-01 14:42:47,289 - __main__ - INFO - encoder.RNNCell.0.day_x_FC.bias	torch.Size([64])
2024-08-01 14:42:47,290 - __main__ - INFO - encoder.RNNCell.0.day_time_FC.weight	torch.Size([64, 59])
2024-08-01 14:42:47,292 - __main__ - INFO - encoder.RNNCell.0.day_time_FC.bias	torch.Size([64])
2024-08-01 14:42:47,294 - __main__ - INFO - encoder.RNNCell.0.day_FC.weight	torch.Size([64, 128])
2024-08-01 14:42:47,296 - __main__ - INFO - encoder.RNNCell.0.day_FC.bias	torch.Size([64])
2024-08-01 14:42:47,298 - __main__ - INFO - encoder.RNNCell.0.hour_x_FC.weight	torch.Size([64, 2])
2024-08-01 14:42:47,300 - __main__ - INFO - encoder.RNNCell.0.hour_x_FC.bias	torch.Size([64])
2024-08-01 14:42:47,302 - __main__ - INFO - encoder.RNNCell.0.hour_time_FC.weight	torch.Size([64, 59])
2024-08-01 14:42:47,304 - __main__ - INFO - encoder.RNNCell.0.hour_time_FC.bias	torch.Size([64])
2024-08-01 14:42:47,306 - __main__ - INFO - encoder.RNNCell.0.hour_FC.weight	torch.Size([64, 128])
2024-08-01 14:42:47,308 - __main__ - INFO - encoder.RNNCell.0.hour_FC.bias	torch.Size([64])
2024-08-01 14:42:47,310 - __main__ - INFO - encoder.RNNCell.0.fusion_x_time2.weight	torch.Size([64, 192])
2024-08-01 14:42:47,312 - __main__ - INFO - encoder.RNNCell.0.fusion_x_time2.bias	torch.Size([64])
2024-08-01 14:42:47,314 - __main__ - INFO - encoder.RNNCell.0.gate_FC2.weight	torch.Size([64, 64])
2024-08-01 14:42:47,316 - __main__ - INFO - encoder.RNNCell.0.gate_FC2.bias	torch.Size([64])
2024-08-01 14:42:47,318 - __main__ - INFO - encoder.RNNCell.0.info_FC2.weight	torch.Size([64, 64])
2024-08-01 14:42:47,320 - __main__ - INFO - encoder.RNNCell.0.info_FC2.bias	torch.Size([64])
2024-08-01 14:42:47,322 - __main__ - INFO - encoder.RNNCell.0.dynGraph.start_FC.weight	torch.Size([64, 128])
2024-08-01 14:42:47,324 - __main__ - INFO - encoder.RNNCell.0.dynGraph.start_FC.bias	torch.Size([64])
2024-08-01 14:42:47,325 - __main__ - INFO - encoder.RNNCell.0.dynGraph.fc.0.weight	torch.Size([4, 64])
2024-08-01 14:42:47,327 - __main__ - INFO - encoder.RNNCell.0.dynGraph.fc.2.weight	torch.Size([64, 4])
2024-08-01 14:42:47,329 - __main__ - INFO - encoder.RNNCell.0.GCN_update1.weight	torch.Size([4])
2024-08-01 14:42:47,331 - __main__ - INFO - encoder.RNNCell.0.GCN_update1.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:47,333 - __main__ - INFO - encoder.RNNCell.0.GCN_update1.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:47,335 - __main__ - INFO - encoder.RNNCell.0.GCN_update2.weight	torch.Size([4])
2024-08-01 14:42:47,337 - __main__ - INFO - encoder.RNNCell.0.GCN_update2.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:47,339 - __main__ - INFO - encoder.RNNCell.0.GCN_update2.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:47,341 - __main__ - INFO - encoder.RNNCell.0.GCN_reset1.weight	torch.Size([4])
2024-08-01 14:42:47,343 - __main__ - INFO - encoder.RNNCell.0.GCN_reset1.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:47,345 - __main__ - INFO - encoder.RNNCell.0.GCN_reset1.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:47,346 - __main__ - INFO - encoder.RNNCell.0.GCN_reset2.weight	torch.Size([4])
2024-08-01 14:42:47,349 - __main__ - INFO - encoder.RNNCell.0.GCN_reset2.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:47,350 - __main__ - INFO - encoder.RNNCell.0.GCN_reset2.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:47,352 - __main__ - INFO - encoder.RNNCell.0.GCN_cell1.weight	torch.Size([4])
2024-08-01 14:42:47,354 - __main__ - INFO - encoder.RNNCell.0.GCN_cell1.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:47,356 - __main__ - INFO - encoder.RNNCell.0.GCN_cell1.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:47,358 - __main__ - INFO - encoder.RNNCell.0.GCN_cell2.weight	torch.Size([4])
2024-08-01 14:42:47,360 - __main__ - INFO - encoder.RNNCell.0.GCN_cell2.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:47,362 - __main__ - INFO - encoder.RNNCell.0.GCN_cell2.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:47,364 - __main__ - INFO - encoder.RNNCell.0.layerNorm.weight	torch.Size([64])
2024-08-01 14:42:47,365 - __main__ - INFO - encoder.RNNCell.0.layerNorm.bias	torch.Size([64])
2024-08-01 14:42:47,367 - __main__ - INFO - decoder.RNNCell.0.input_FC.weight	torch.Size([64, 61])
2024-08-01 14:42:47,369 - __main__ - INFO - decoder.RNNCell.0.input_FC.bias	torch.Size([64])
2024-08-01 14:42:47,371 - __main__ - INFO - decoder.RNNCell.0.fusion_x_time.weight	torch.Size([64, 64])
2024-08-01 14:42:47,373 - __main__ - INFO - decoder.RNNCell.0.fusion_x_time.bias	torch.Size([64])
2024-08-01 14:42:47,375 - __main__ - INFO - decoder.RNNCell.0.gate_FC1.weight	torch.Size([64, 64])
2024-08-01 14:42:47,377 - __main__ - INFO - decoder.RNNCell.0.gate_FC1.bias	torch.Size([64])
2024-08-01 14:42:47,379 - __main__ - INFO - decoder.RNNCell.0.info_FC1.weight	torch.Size([64, 64])
2024-08-01 14:42:47,381 - __main__ - INFO - decoder.RNNCell.0.info_FC1.bias	torch.Size([64])
2024-08-01 14:42:47,383 - __main__ - INFO - decoder.RNNCell.0.dynGraph.start_FC.weight	torch.Size([64, 128])
2024-08-01 14:42:47,385 - __main__ - INFO - decoder.RNNCell.0.dynGraph.start_FC.bias	torch.Size([64])
2024-08-01 14:42:47,387 - __main__ - INFO - decoder.RNNCell.0.dynGraph.fc.0.weight	torch.Size([4, 64])
2024-08-01 14:42:47,389 - __main__ - INFO - decoder.RNNCell.0.dynGraph.fc.2.weight	torch.Size([64, 4])
2024-08-01 14:42:47,391 - __main__ - INFO - decoder.RNNCell.0.GCN_update1.weight	torch.Size([4])
2024-08-01 14:42:47,393 - __main__ - INFO - decoder.RNNCell.0.GCN_update1.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:47,395 - __main__ - INFO - decoder.RNNCell.0.GCN_update1.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:47,397 - __main__ - INFO - decoder.RNNCell.0.GCN_update2.weight	torch.Size([4])
2024-08-01 14:42:47,399 - __main__ - INFO - decoder.RNNCell.0.GCN_update2.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:47,400 - __main__ - INFO - decoder.RNNCell.0.GCN_update2.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:47,402 - __main__ - INFO - decoder.RNNCell.0.GCN_reset1.weight	torch.Size([4])
2024-08-01 14:42:47,404 - __main__ - INFO - decoder.RNNCell.0.GCN_reset1.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:47,406 - __main__ - INFO - decoder.RNNCell.0.GCN_reset1.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:47,408 - __main__ - INFO - decoder.RNNCell.0.GCN_reset2.weight	torch.Size([4])
2024-08-01 14:42:47,410 - __main__ - INFO - decoder.RNNCell.0.GCN_reset2.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:47,412 - __main__ - INFO - decoder.RNNCell.0.GCN_reset2.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:47,414 - __main__ - INFO - decoder.RNNCell.0.GCN_cell1.weight	torch.Size([4])
2024-08-01 14:42:47,416 - __main__ - INFO - decoder.RNNCell.0.GCN_cell1.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:47,418 - __main__ - INFO - decoder.RNNCell.0.GCN_cell1.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:47,420 - __main__ - INFO - decoder.RNNCell.0.GCN_cell2.weight	torch.Size([4])
2024-08-01 14:42:47,422 - __main__ - INFO - decoder.RNNCell.0.GCN_cell2.mlp.mlp.weight	torch.Size([64, 384])
2024-08-01 14:42:47,424 - __main__ - INFO - decoder.RNNCell.0.GCN_cell2.mlp.mlp.bias	torch.Size([64])
2024-08-01 14:42:47,426 - __main__ - INFO - decoder.RNNCell.0.layerNorm.weight	torch.Size([64])
2024-08-01 14:42:47,428 - __main__ - INFO - decoder.RNNCell.0.layerNorm.bias	torch.Size([64])
2024-08-01 14:42:47,429 - __main__ - INFO - decoder.fc_final.weight	torch.Size([2, 64])
2024-08-01 14:42:47,432 - __main__ - INFO - decoder.fc_final.bias	torch.Size([2])
2024-08-01 14:42:47,434 - __main__ - INFO - transform.FC_q.weight	torch.Size([64, 59])
2024-08-01 14:42:47,436 - __main__ - INFO - transform.FC_q.bias	torch.Size([64])
2024-08-01 14:42:47,438 - __main__ - INFO - transform.FC_k.weight	torch.Size([64, 177])
2024-08-01 14:42:47,439 - __main__ - INFO - transform.FC_k.bias	torch.Size([64])
2024-08-01 14:42:47,441 - __main__ - INFO - transform.FC_v.weight	torch.Size([64, 64])
2024-08-01 14:42:47,443 - __main__ - INFO - transform.FC_v.bias	torch.Size([64])
2024-08-01 14:42:47,445 - __main__ - INFO - transform.FC.weight	torch.Size([64, 128])
2024-08-01 14:42:47,447 - __main__ - INFO - transform.FC.bias	torch.Size([64])
2024-08-01 14:42:47,448 - __main__ - INFO - Net's total params:415282
2024-08-01 14:42:47,448 - __main__ - INFO - Optimizer's state_dict:
2024-08-01 14:42:47,449 - __main__ - INFO - state	{}
2024-08-01 14:42:47,449 - __main__ - INFO - param_groups	[{'lr': 0.001, 'betas': (0.9, 0.999), 'eps': 1e-08, 'weight_decay': 0.0001, 'amsgrad': False, 'maximize': False, 'foreach': None, 'capturable': False, 'differentiable': False, 'fused': None, 'initial_lr': 0.001, 'params': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89]}]
2024-08-01 14:42:47,451 - __main__ - INFO - Number of model parameters is 415282
2024-08-01 14:42:47,451 - __main__ - INFO - Start testing phase.....
